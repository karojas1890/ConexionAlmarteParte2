{% extends "layout_terapeuta.html" %}

{% block title %}Gesti√≥n de Pacientes{% endblock %}

{% block content %}

<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

    <div class="container">
       
        <div class="page-header">
            <h2>Gesti√≥n de Pacientes</h2>
            <p>Administra la informaci√≥n de tus pacientes y su historial cl√≠nico</p>
        </div>

        <div class="actions-bar">
            <div class="search-box">
                <span class="search-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </span>
                <input type="text" placeholder="Buscar paciente por nombre, email o tel√©fono..." id="searchInput">
            </div>
            <button class="btn-add" onclick="openAddPatientModal()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Agregar Paciente
            </button>
        </div>

       
        <div class="patients-grid" id="patientsGrid">
            
            
            </div>
        </div>
  

   

        <!-- Modal de confirmaci√≥n -->
        <div id="successModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div class="modal-icon">‚úÖ</div>
                <h2></h2>
                <p></p>
            </div>
        </div>
    
    
  
         <div class="modal-uss" id="addPatientModal">
  <div class="modal-content-uss">
    <div class="modal-header">
      <h3>Crear Cuenta</h3>
      <button class="btn-close" onclick="closeAddPatientModal()">√ó</button>
    </div>

    <div class="modal-body">

     <div class="almarte-search-section" style="margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, #e8f5f4 0%, #f0fafa 100%); border-radius: 10px; border: 2px solid #5BA8A0;">
         <h4 style="margin: 0 0 15px; color: #4A9B94; font-size: 16px; font-weight: 600;">üîç Buscar en Registro Civil</h4>
          <div style="display: flex; gap: 10px; margin-bottom: 10px;">
               <input type="text" id="almarte-cedula-search" placeholder="Ingrese c√©dula (ej: 304660065)" maxlength="20" style="flex: 1; padding: 10px; border: 2px solid #5BA8A0; border-radius: 8px; font-size: 14px; font-family: inherit;">
                <button type="button" onclick="almarte_searchCivil()" style="padding: 10px 20px; background: linear-gradient(135deg, #5BA8A0 0%, #4A9B94 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px;">Buscar</button>
            </div>
            _<div id="almarte-search-status" style="font-size: 13px; color: #4A9B94;"></div>
      </div>


      <form id="addPatientForm">
        <div class="form-row">
          <div class="form-group">
            <label>Identificaci√≥n</label>
            <input type="text" id="identification" required maxlength="25">
          </div>
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" id="nombre" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Primer Apellido</label>
            <input type="text" id="apellido1" required>
          </div>
          <div class="form-group">
            <label>Segundo Apellido</label>
            <input type="text" id="apellido2" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Tel√©fono</label>
            <input type="tel" id="telefono"  required maxlength="8" minlength="8">
          </div>
          <div class="form-group">
            <label>Fecha de Nacimiento</label>
            <input type="date" id="fechaNacimiento" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Pais</label>
            <select id="pais" required>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Provincia</label>
            <select id="provincia" required>
            </select>
          </div>
          <div class="form-group">
            <label>Cant√≥n</label>
            <select id="canton" required>
              
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Distrito</label>
            <select id="distrito" required>
              
            </select>
          </div>
          <div class="form-group">
            <label>Direcci√≥n Exacta</label>
            <input type="text" id="direccion" required>
          </div>
        </div>
       <div class="form-row">
          <div class="form-group">
            <label>Correo Electronico</label>
            <input type="email" id="correo" required>
          </div>
        <div class="form-group">
          <label>Ocupacion</label>
          <input type="text" id="ocupacion" required>
        </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Edad</label>
            <input type="number" id="edad" required>
          </div>
        <div class="form-group">
          <label>Lugar de Trabajo / Estudio</label>
          <input type="text" id="lugarTrabajo" required>
        </div>
        </div>
        <div class="modal-footer">
      <button type="button" class="btn-submit" onclick="submitPatient()">Crear Cuenta</button>

    </div>
  </div>
      </form>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    const PATIENTS_URL="{{ url_for('pacientes.VerPacientes') }}"
    const PAIS_URL="{{ url_for('geolocalizacion.GetPais') }}"
    const PROVINCIA_URL="{{ url_for('geolocalizacion.GetEstado') }}"
    const CIUDAD_URL="{{ url_for('geolocalizacion.GetCiudad') }}"
    const BARRIO_URL="{{ url_for('geolocalizacion.GetBarrio') }}"
    const REGISTROCIVIL_URL = "{{ url_for('Usuarios.ConsultaRegistroCivil') }}";
</script>
<script src="{{ url_for('static', filename='js/gestionPacientes.js') }}"></script>

  {% endblock %}

